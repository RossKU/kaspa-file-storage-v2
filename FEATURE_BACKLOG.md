# Kaspa P2P File Storage - 機能バックログ

最終更新: 2025-01-09

## 現在の機能状態 (v4.7.15)

### アップロード機能

| 機能 | 状態 | 説明 | 備考 |
|------|------|------|------|
| **パスワードを.kaspaファイルに含める** | ❌ OFF | チェックボックスは無効化されている | セキュリティリスクのため現在無効 |
| **メタTxIDを使用** | ✅ ON (デフォルト) | チェックボックスはデフォルトでチェック | 推奨：履歴から簡単に共有可能 |
| **ランダムCIDを使用** | ✅ ON | 検閲回避機能として動作中 | 正常動作 |
| **暗号化** | ✅ ON | AES-256-GCM暗号化を使用 | 常に有効 |
| **圧縮** | ✅ ON | LZベースの圧縮を使用 | ファイルサイズ削減 |
| **WebSocket監視** | ✅ ON | アップロード後の確認に使用 | 自動で90秒後に停止 |

### ダウンロード機能

| 機能 | 状態 | 説明 | 備考 |
|------|------|------|------|
| **自動判別して復元** | ✅ ON | TxIDまたは.kaspaファイルを自動識別 | v4.7.14で修正済み |
| **並列ダウンロード** | ✅ ON | 100チャンク/秒の高速ダウンロード | ParallelDownloaderクラス使用 |
| **ディレクトリサポート** | ✅ ON | フォルダ構造の保存・復元 | DownloadManager実装済み |

### 履歴機能

| 機能 | 状態 | 説明 | 備考 |
|------|------|------|------|
| **履歴の保存** | ⚠️ 制限付き | ワークスペース設定時のみ動作 | 作業フォルダ未設定時は保存されない |
| **履歴の暗号化** | ✅ ON | .kenvファイルとして暗号化保存 | AES-256-GCM使用 |
| **5種類のダウンロード** | ✅ ON | 様々な形式でのファイル共有対応 | v4.5.6で実装 |

## 既知の問題

### 優先度: 高

1. **ワークスペース未設定時の問題**
   - 現象: メタTxIDが作成されない
   - 影響: 履歴にTxIDのみコピーするとチャンクTxIDがコピーされ、復号化エラーになる
   - 対策案: ワークスペース未設定時の警告強化

2. **チャンクTxID vs メタTxIDの区別**
   - 現象: UIで区別がつかない
   - 影響: 誤ったTxIDでの復元試行
   - 対策案: UIに明確な表示を追加

### 優先度: 中

1. **パスワード付き.kaspaファイル**
   - 現象: 機能がコメントアウトされている
   - 影響: セキュリティオプションの制限
   - 対策案: v4.8.0で安全な実装を検討

## 今後の実装予定

### v4.8.0 (計画中)
- [ ] パスワード付き.kaspaファイルの安全な実装
- [ ] チャンクTxID/メタTxIDの明確な区別表示
- [ ] ワークスペース未設定時の警告ダイアログ

### v4.9.0 (将来)
- [ ] バッチダウンロード機能
- [ ] 選択的ファイルダウンロード
- [ ] GPU並列化によるTxIDマイニング高速化

## 技術的負債

1. **グローバル変数の段階的削除**
   - `window.kaspaMetadata` (残骸として残存)
   - DownloadManagerへの移行を継続

2. **エラーハンドリングの統一**
   - 各機能で異なるエラー処理
   - 統一的なエラーハンドラーが必要

## 変更履歴

- v4.7.15: メタTxチェックボックスをデフォルトONに修正
- v4.7.14: 自動判別復元のメタデータクリア機能追加
- v4.7.6: DownloadManager実装完了
- v4.7.0: DownloadManagerパターン導入開始